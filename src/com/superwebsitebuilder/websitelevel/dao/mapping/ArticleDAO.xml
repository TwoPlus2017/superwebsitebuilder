<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.superwebsitebuilder.websitelevel.dao.ArticleDAO" >

	<resultMap id="randomKeyWordMap" type="com.superwebsitebuilder.websitelevel.data.businesslogic.ArticleData">
		<result column="ID" 				property="id"																		/>
		<result column="TITLE" 				property="title" 				javaType="string" jdbcType="VARCHAR" 				/>
		<result column="SELF_URL" 			property="selfUrl" 				javaType="string" jdbcType="VARCHAR" 				/>
	</resultMap>
	
	<select id="getRandomHotKeyWordsList" parameterType="int" resultMap="randomKeyWordMap">
		SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_HOT
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_HOT)-(SELECT MIN(ID) FROM SWSBT_KW_HOT)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_HOT) 
		AND ENABLED = 1 
		LIMIT #{counter};
	</select>
	
	<select id="getRandomKeyWordsList" resultMap="randomKeyWordMap">
	SELECT ID, TITLE, SELF_URL FROM (
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_A
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_A)-(SELECT MIN(ID) FROM SWSBT_KW_A)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_A) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_B
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_B)-(SELECT MIN(ID) FROM SWSBT_KW_B)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_B) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_C
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_C)-(SELECT MIN(ID) FROM SWSBT_KW_C)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_C) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_D
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_D)-(SELECT MIN(ID) FROM SWSBT_KW_D)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_D) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_E
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_E)-(SELECT MIN(ID) FROM SWSBT_KW_E)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_E) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_F
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_F)-(SELECT MIN(ID) FROM SWSBT_KW_F)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_F) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_G
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_G)-(SELECT MIN(ID) FROM SWSBT_KW_G)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_G) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_H
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_H)-(SELECT MIN(ID) FROM SWSBT_KW_H)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_H) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_I
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_I)-(SELECT MIN(ID) FROM SWSBT_KW_I)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_I) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_J
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_J)-(SELECT MIN(ID) FROM SWSBT_KW_J)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_J) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_K
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_K)-(SELECT MIN(ID) FROM SWSBT_KW_K)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_K) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_L
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_L)-(SELECT MIN(ID) FROM SWSBT_KW_L)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_L) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_M
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_M)-(SELECT MIN(ID) FROM SWSBT_KW_M)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_M) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_N
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_N)-(SELECT MIN(ID) FROM SWSBT_KW_N)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_N) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_O
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_O)-(SELECT MIN(ID) FROM SWSBT_KW_O)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_O) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_P
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_P)-(SELECT MIN(ID) FROM SWSBT_KW_P)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_P) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_Q
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_Q)-(SELECT MIN(ID) FROM SWSBT_KW_Q)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_Q) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_R
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_R)-(SELECT MIN(ID) FROM SWSBT_KW_R)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_R) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_S
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_S)-(SELECT MIN(ID) FROM SWSBT_KW_S)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_S) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_T
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_T)-(SELECT MIN(ID) FROM SWSBT_KW_T)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_T) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_U
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_U)-(SELECT MIN(ID) FROM SWSBT_KW_U)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_U) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_V
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_V)-(SELECT MIN(ID) FROM SWSBT_KW_V)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_V) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_W
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_W)-(SELECT MIN(ID) FROM SWSBT_KW_W)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_W) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_X
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_X)-(SELECT MIN(ID) FROM SWSBT_KW_X)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_X) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_Y
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_Y)-(SELECT MIN(ID) FROM SWSBT_KW_Y)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_Y) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_Z
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_Z)-(SELECT MIN(ID) FROM SWSBT_KW_Z)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_Z) AND ENABLED = 1 LIMIT 2)
		
		UNION
		
		(SELECT ID, TITLE, SELF_URL 
		FROM SWSBT_KW_09
		WHERE ID >= ((SELECT MAX(ID) FROM SWSBT_KW_09)-(SELECT MIN(ID) FROM SWSBT_KW_09)) * RAND() + (SELECT MIN(ID) FROM SWSBT_KW_09) AND ENABLED = 1 LIMIT 2)
		) A 
		
		ORDER BY A.ID
	</select>
</mapper>